{"version":3,"sources":["uni-app:///main.js","webpack:///D:/1项目实践/前端代码！！！/pages/topic-detail/topic-detail.vue?a4a0","webpack:///D:/1项目实践/前端代码！！！/pages/topic-detail/topic-detail.vue?8d6a","webpack:///D:/1项目实践/前端代码！！！/pages/topic-detail/topic-detail.vue?0e08","webpack:///D:/1项目实践/前端代码！！！/pages/topic-detail/topic-detail.vue?234f","uni-app:///pages/topic-detail/topic-detail.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,gH;AACAA,UAAU,CAACC,oBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAyH;AACzH;AACgE;AACL;;;AAG3D;AACmK;AACnK,gBAAgB,6KAAU;AAC1B,EAAE,kFAAM;AACR,EAAE,uFAAM;AACR,EAAE,gGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,2FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAymB,CAAgB,snBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACkC7nB;AACA;AACA,wBADA;AAEA,gCAFA;AAGA,0BAHA;AAIA,sBAJA,EADA;;AAOA,MAPA,kBAOA;AACA;AACA;AACA,sDADA;AAEA,wBAFA;AAGA,oBAHA;AAIA,sBAJA;AAKA,sBALA,EADA;;AAQA,iBARA;AASA;AACA,iCADA;AAEA,kCAFA,CATA;;AAaA;AACA,iEADA;AAEA,iEAFA,CAbA;;;AAkBA,GA1BA;AA2BA;AACA,eA5BA,2BA4BA;AACA;AACA;AACA,GA/BA;AAgCA;AACA,mBAjCA,+BAiCA;AACA;AACA,GAnCA;AAoCA,QApCA,kBAoCA,CApCA,EAoCA;AACA;AACA;AACA;AACA,GAxCA;AAyCA;AACA,cADA,sBACA,IADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBATA;;AAWA,KAbA;AAcA;AACA,iBAfA,yBAeA,IAfA,EAeA;AACA;AACA;AACA;AACA,OAFA;AAGA;AACA,uBANA,CAMA;AACA,KAtBA;AAuBA;AACA,iBAxBA,yBAwBA,IAxBA,EAwBA;AACA;AACA;AACA;AACA;AACA,OAJA;AAKA,KA9BA;AA+BA,iBA/BA,yBA+BA,IA/BA,EA+BA;AACA;AACA;AACA,OAFA;AAGA;AACA;AACA;AACA;AACA;AACA,KAxCA;AAyCA;AACA,UA1CA,kBA0CA,GA1CA,EA0CA;AACA;AACA;AACA;AACA;AACA;AACA,KAhDA;AAiDA;AACA,WAlDA,qBAkDA;AACA,mBADA,oBACA,kBADA,mBACA,kCADA;AAEA,2DAFA,iHAEA,GAFA,6BAEA,GAFA;;AAIA,gDAJA;AAKA,iEALA;;AAOA,mBAPA,GAOA,EAPA;AAQA,oBARA,GAQA,kBARA;AASA;AACA;AACA;AACA;AACA;AACA,0CAdA;AAeA,gGAfA;AAgBA,KAlEA;AAmEA;AACA,YApEA,oBAoEA,IApEA,EAoEA;AACA;AACA,4BADA;AAEA,kCAFA;AAGA,oCAHA;AAIA,0CAJA;AAKA,mBALA;AAMA,yBANA;AAOA,mBAPA,EAOA;AACA,+BARA;AASA,oBATA;AAUA,uBAVA;AAWA,2BAXA;AAYA;AACA,uEADA;AAEA,kCAFA;AAGA,gCAHA,EAZA;;AAiBA,gCAjBA;AAkBA,sCAlBA;AAmBA,+BAnBA;AAoBA,mCApBA;AAqBA,mCArBA;;AAuBA,KA5FA;AA6FA;AACA,YA9FA,sBA8FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAtGA;AAuGA;AACA,UAxGA,kBAwGA,KAxGA,EAwGA;AACA;AACA;AACA;AACA,KA5GA,EAzCA,E","file":"pages/topic-detail/topic-detail.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/topic-detail/topic-detail.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./topic-detail.vue?vue&type=template&id=8074c734&\"\nvar renderjs\nimport script from \"./topic-detail.vue?vue&type=script&lang=js&\"\nexport * from \"./topic-detail.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/topic-detail/topic-detail.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./topic-detail.vue?vue&type=template&id=8074c734&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./topic-detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./topic-detail.vue?vue&type=script&lang=js&\"","<template>\n\t<view>\n\t\t<!-- 话题介绍 -->\r\n\t\t<topic-info :item=\"topicInfo\"></topic-info>\r\n\t\t<!-- tabbar切换 -->\r\n\t\t<swiper-tab-head \r\n\t\t:tabBars=\"tabBars\" \r\n\t\t:tabIndex=\"tabIndex\"\r\n\t\t@tabtap=\"tabtap\"\r\n\t\tscrollItemStyle=\"width:50%;\"\r\n\t\tscrollStyle=\"border-bottom:0;\">\r\n\t\t</swiper-tab-head>\r\n\t\t<!-- 列表 -->\r\n\t\t<view class=\"topic-detail-list\">\r\n\t\t\t<block v-for=\"(item,index) in tablist\" :key=\"index\">\r\n\t\t\t\t<template v-if=\"tabIndex==index\">\r\n\t\t\t\t\t<!-- 列表 -->\r\n\t\t\t\t\t<block v-for=\"(list,listindex) in item.list\" :key=\"listindex\">\r\n\t\t\t\t\t\t<common-list @changeevent=\"updateData\" :item=\"list\" :index=\"listindex\"></common-list>\r\n\t\t\t\t\t</block>\r\n\t\t\t\t\t<!-- 上拉加载 -->\r\n\t\t\t\t\t<load-more :loadtext=\"item.loadtext\"></load-more>\r\n\t\t\t\t</template>\r\n\t\t\t</block>\r\n\t\t</view>\r\n\t\t\n\t</view>\n</template>\n\n<script>\r\n\timport topicInfo from \"../../components/topic/topic-info.vue\";\r\n\timport swiperTabHead from \"../../components/index/swiper-tab-head.vue\";\r\n\timport commonList from \"../../components/common/common-list.vue\";\r\n\timport loadMore from \"../../components/common/load-more.vue\";\n\texport default {\r\n\t\tcomponents:{\r\n\t\t\ttopicInfo,\r\n\t\t\tswiperTabHead,\r\n\t\t\tcommonList,\r\n\t\t\tloadMore\r\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\ttopicInfo:{\r\n\t\t\t\t\ttitlepic:\"../../static/demo/topicpic/13.jpeg\",\r\n\t\t\t\t\ttitle:\"忆往事，敬余生\",\r\n\t\t\t\t\tdesc:\"我是描述\",\r\n\t\t\t\t\ttotalnum:1000,\r\n\t\t\t\t\ttodaynum:1000,\r\n\t\t\t\t},\r\n\t\t\t\ttabIndex:0,\r\n\t\t\t\ttabBars:[\r\n\t\t\t\t\t{ name:\"默认\",id:\"moren\" },\r\n\t\t\t\t\t{ name:\"最新\",id:\"zuixin\" },\r\n\t\t\t\t],\r\n\t\t\t\ttablist:[\r\n\t\t\t\t\t{ loadtext:\"上拉加载更多\",list:[],firstload:false,page:1},\r\n\t\t\t\t\t{ loadtext:\"上拉加载更多\",list:[],firstload:false,page:1},\r\n\t\t\t\t]\n\t\t\t};\n\t\t},\r\n\t\t// 上拉触底事件\r\n\t\tonReachBottom() {\r\n\t\t\t// 上拉加载\r\n\t\t\tthis.loadmore();\r\n\t\t},\r\n\t\t// 监听下拉刷新 \r\n\t\tonPullDownRefresh(){\r\n\t\t\tthis.getList();\r\n\t\t},\r\n\t\tonLoad(e) {\r\n\t\t\tthis.__init(JSON.parse(e.detail));\r\n\t\t\t// 开启监听\r\n\t\t\tuni.$on('updateData',this.updateData);\r\n\t\t},\r\n\t\tmethods:{\r\n\t\t\tupdateData(data){\r\n\t\t\t\tswitch (data.type){\r\n\t\t\t\t\tcase \"guanzhu\":\r\n\t\t\t\t\tthis.updateGuanZhu(data)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"support\":\r\n\t\t\t\t\tthis.updateSupport(data);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'updateComment':\r\n\t\t\t\t\tthis.updateComment(data);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 更新评论数\r\n\t\t\tupdateComment(data){\r\n\t\t\t\t// 拿到当前对象\r\n\t\t\t\tlet obj = this.tablist[this.tabIndex].list.find(value =>{\r\n\t\t\t\t\treturn value.id === data.post_id;\r\n\t\t\t\t});\r\n\t\t\t\tif (!obj) return;\r\n\t\t\t\tobj.commentnum++; // 评论数+1\r\n\t\t\t},\r\n\t\t\t// 更新关注信息\r\n\t\t\tupdateGuanZhu(data){\r\n\t\t\t\tthis.tablist[this.tabIndex].list.forEach((item,index)=>{\r\n\t\t\t\t\tif (item.userid === data.userid) {\r\n\t\t\t\t\t\titem.isguanzhu = data.data;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tupdateSupport(data){\r\n\t\t\t\tlet obj = this.tablist[this.tabIndex].list.find((item)=>{\r\n\t\t\t\t\treturn item.id === data.post_id;\r\n\t\t\t\t})\r\n\t\t\t\tif(!obj || obj.infonum.index === 1) return;\r\n\t\t\t\tif (data.do == 'ding') {\r\n\t\t\t\t\tobj.infonum.index = 1;\r\n\t\t\t\t\tobj.goodnum++;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 初始化\r\n\t\t\t__init(obj){\r\n\t\t\t\t// 修改标题\r\n\t\t\t\tuni.setNavigationBarTitle({ title: obj.title });\r\n\t\t\t\tthis.topicInfo = obj;\r\n\t\t\t\t// 获取列表数据\r\n\t\t\t\tthis.getList();\r\n\t\t\t},\r\n\t\t\t// 获取数据\r\n\t\t\tasync getList(){\r\n\t\t\t\tlet url = `/topic/${this.topicInfo.id}/post/${this.tablist[this.tabIndex].page}`;\r\n\t\t\t\tlet [err,res] = await this.$http.get(url,{},{token:true});\r\n\t\t\t\t// 错误处理\r\n\t\t\t\tif (!this.$http.errorCheck(err,res)) {\r\n\t\t\t\t\treturn this.tablist[this.tabIndex].loadtext=\"上拉加载更多\";\r\n\t\t\t\t}\r\n\t\t\t\tlet arr = [];\r\n\t\t\t\tlet list = res.data.data.list;\r\n\t\t\t\tfor (let i = 0; i < list.length; i++) {\r\n\t\t\t\t\tarr.push(this.__format(list[i]));\r\n\t\t\t\t}\r\n\t\t\t\tthis.tablist[this.tabIndex].list = this.tablist[this.tabIndex].page > 1 ? this.tablist[this.tabIndex].list.concat(arr) : arr;\r\n\t\t\t\tthis.tablist[this.tabIndex].firstload = true;\r\n\t\t\t\tuni.stopPullDownRefresh();\r\n\t\t\t\treturn\tthis.tablist[this.tabIndex].loadtext=(list.length < 10) ?\"没有更多数据了\" : \"上拉加载更多\";\r\n\t\t\t},\r\n\t\t\t// 转换格式\r\n\t\t\t__format(item){\r\n\t\t\t\treturn {\r\n\t\t\t\t\tuserid:item.user.id,\r\n\t\t\t\t\tuserpic:item.user.userpic,\r\n\t\t\t\t\tusername:item.user.username,\r\n\t\t\t\t\tisguanzhu:!!item.user.fens.length,\r\n\t\t\t\t\tid:item.id,\r\n\t\t\t\t\ttitle:item.title,\r\n\t\t\t\t\ttype:\"img\", // img:图文,video:视频\r\n\t\t\t\t\ttitlepic:item.titlepic,\r\n\t\t\t\t\tvideo:false,\r\n\t\t\t\t\tpath:item.path,\r\n\t\t\t\t\tshare:!!item.share,\r\n\t\t\t\t\tinfonum:{\r\n\t\t\t\t\t\tindex:(item.support.length>0) ? (item.support[0].type+1) : 0,\r\n\t\t\t\t\t\tdingnum:item.ding_count,\r\n\t\t\t\t\t\tcainum:item.cai_count,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tgoodnum:item.ding_count,\r\n\t\t\t\t\tcommentnum:item.comment_count,\r\n\t\t\t\t\tsharenum:item.sharenum,\r\n\t\t\t\t\tsex:item.user.userinfo.sex,\r\n\t\t\t\t\tage:item.user.userinfo.age,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 上拉加载\r\n\t\t\tloadmore(){\r\n\t\t\t\tif(this.tablist[this.tabIndex].loadtext!=\"上拉加载更多\") return;\r\n\t\t\t\t// 修改状态\r\n\t\t\t\tthis.tablist[this.tabIndex].loadtext=\"加载中...\";\r\n\t\t\t\t// 页数+1\r\n\t\t\t\tthis.tablist[this.tabIndex].page++;\r\n\t\t\t\t// 获取数据\r\n\t\t\t\tthis.getList();\r\n\t\t\t},\r\n\t\t\t// tabbar点击事件\r\n\t\t\ttabtap(index){\r\n\t\t\t\tthis.tabIndex=index;\r\n\t\t\t\tthis.tablist[this.tabIndex].page = 1;\r\n\t\t\t\tthis.getList();\r\n\t\t\t},\r\n\t\t}\n\t}\n</script>\n\n<style>\n\n</style>\n"],"sourceRoot":""}